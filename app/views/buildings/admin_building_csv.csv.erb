<%- headers = ['Building Name','Building Private Notes','Building Public Description','Building Website','Building youtube url','Building-Level Amenities','Case Name','Dotsignal Code','Featured Building','Income Restricted','Is a master?','Is a sign out key?','Is active?','Is for a commercial property?','Key Status','Landlord','LLC name','Neighborhood','Office Location','Pet policy','Point of Contact','Rental Terms','Section 8','Short Address Change','Street Address','Streeteasy Eligibility','Tag Number','Third Tier','Train Lines','Utilities','Year Build'] -%>
<%= CSV.generate_line(headers).strip %>
<%- @buildings.each do |building| -%>
  <%= [building.building_name,(building.notes || "").gsub('"', '""'), building.description, building.building_website, building.building_youtube_url, @amenities[building.id] ? @amenities[building.id].map{|a| a.name.titleize}.join(', ') : nil, building.building_case_name, building.dotsignal_code, building.featured, building.income_restricted, building.building_master, building.building_signout_key, building.building_key_active, building.building_commercial_property, building.building_key_status, building.landlord_code, building.llc_name, building.neighborhood_name, building.building_office_location, building.pet_policy ? building.pet_policy.name : '', building.point_of_contact ? User.find(building.point_of_contact).name : '', building.rental_term ? building.rental_term.name.titleize : '', building.section_8, building.route, building.street_address, building.streeteasy_eligibility, building.building_tag_number, building.third_tier, building.trains ? building.trains.map(&:name).join(",") : '', @utilities[building.id] ? @utilities[building.id].map{|a| a.utility_name.titleize}.join(', ') : nil, building.year_build].to_csv.strip.html_safe %>
<%- end -%>
