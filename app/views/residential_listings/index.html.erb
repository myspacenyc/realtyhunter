<% provide(:title, 'Residential Listings') %>
<div id="residential-desktop" class="">
  <div id="section-name" data-name="residential_listings">

  <%= render partial: "residential_listings/announcements",
      locals: {announcement_items: @announcement_items} %>

  <div class="row">
    <div class="col-sm-6">
      <h1>Rental Listings</h1>
    </div>
    <div class="hidden-xs hidden-sm col-sm-6 form-label-responsive page-header-buttons">
      <% if current_user.is_management? || current_user.is_listings_manager? %>
        <%= link_to 'Make Announcement', new_announcement_path,
            class: "btn btn-warning btn-sm link-as-button management-action-button" %>
        <%= link_to 'Add a Deal', new_deal_path,
            class: 'btn btn-warning btn-sm link-as-button management-action-button' %>
        <%= link_to 'Add a unit', new_residential_listing_path,
            class: 'btn btn-warning btn-sm link-as-button management-action-button' %>
        <%= link_to 'Export to CSV',
            residential_listings_path(params.permit!.merge(format: 'csv')),
            class: 'btn btn-sm btn-warning link-as-button management-action-button',
            target: :_blank %>
        <% if current_user.id == 505 %>
          <%= link_to 'Export Main CSV',
              index_main_path(params.permit!.merge(format: 'csv')),
              class: 'btn btn-sm btn-warning link-as-button management-action-button',
              target: :_blank %>
          <%= link_to 'Export Streeteasy CSV',
              index_streeteasy_path(params.permit!.merge(format: 'csv')),
              class: 'btn btn-sm btn-warning link-as-button management-action-button',
              target: :_blank %>
        <% end %>
        <% if current_user.id == 505 or current_user.id == 112 %>
          <%= link_to 'Admin CSV',
              admin_csv_path(params.permit!.merge(format: 'csv')),
              class: 'btn btn-sm btn-warning link-as-button management-action-button',
              target: :_blank %>
          <%= link_to 'Image CSV',
              image_csv_path(params.permit!.merge(format: 'csv')),
              class: 'btn btn-sm btn-warning link-as-button management-action-button',
              target: :_blank %>
        <% end %>
      <% end %>
    </div>
    <div class="hidden-md hidden-lg col-sm-5 col-sm-left-padding form-label-responsive page-header-buttons">
      <% if current_user.is_management? || current_user.is_listings_manager? %>
        <%= link_to 'Make Announcement', new_announcement_path,
            class: "btn btn-warning btn-sm link-as-button management-action-button" %>
        <%= link_to 'Add a Deal', new_deal_path,
            class: 'btn btn-warning btn-sm link-as-button management-action-button' %>
        <%= link_to 'Add a unit', new_residential_listing_path,
            class: 'btn btn-warning btn-sm link-as-button management-action-button' %>
        <%= link_to 'Export to CSV',
            residential_listings_path(params.permit!.merge(format: 'csv')),
            class:"btn btn-sm btn-warning link-as-button management-action-button",
            target: :_blank %>
      <% end %>
    </div>
  </div>

  <br>

  <div class="row">
    <div class="col-md-3">

      <i class="fa fa-spinner fa-pulse fa-5x res-spinner-desktop listings-spinner-desktop"></i>

      <div class="res-desktop-search-filters hidden-print" id="res-search-filters" data-search-path="<%= filter_residential_listings_path %>">
        <%= form_tag residential_listings_path, method: 'get' do %>
          <div class="row vertical-margin-lg">
            <div class="col-xs-3">
              <%= label_tag(:address, "Address") %>
            </div>
            <div class="col-xs-8 col-sm-left-padding">
            <%= autocomplete_field_tag :address, params[:address],
                autocomplete_building_formatted_street_address_residential_listings_path,
                update_elements: {},
                placeholder: "123 Main St",
                class:'form-control' %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-3">
              <%= label_tag(:unit, "Unit") %>
            </div>
            <div class="col-xs-8 col-sm-left-padding">
              <%= text_field_tag :unit, params[:unit], class:"form-control" %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-3">
              <%= label_tag(:unit, "Alt Address") %>
            </div>
            <div class="col-xs-8 col-sm-left-padding">
              <%= text_field_tag :alt_address, params[:alt_address], class:"form-control" %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-3">
              <%= label_tag(:unit, "Alt Unit") %>
            </div>
            <div class="col-xs-8 col-sm-left-padding">
              <%= text_field_tag :alt_unit, params[:alt_unit], class:"form-control" %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-3">
              <%= label_tag(:unit, "Rent") %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= number_field_tag :rent_min, params[:rent_min], placeholder: "$ min",
                min: 0, max: 1000000, class:"form-control" %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= number_field_tag :rent_max, params[:rent_max], placeholder: "$ max",
                min: 0, max: 1000000, class:"form-control" %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-3">
              <%= label_tag(:unit, "Net") %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= number_field_tag :net_min, params[:net_min], placeholder: "$ min",
                min: 0, max: 1000000, class:"form-control" %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= number_field_tag :net_max, params[:net_max], placeholder: "$ max",
                min: 0, max: 1000000, class:"form-control" %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-3">
              <%= label_tag(:unit, "Gross") %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= number_field_tag :gross_min, params[:gross_min], placeholder: "$ min",
                min: 0, max: 1000000, class:"form-control" %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= number_field_tag :gross_max, params[:gross_max], placeholder: "$ max",
                min: 0, max: 1000000, class:"form-control" %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-3">
              <%= label_tag(:unit, "Beds") %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= select_tag(:bed_min,
                options_for_select(%w(Any Studio/Loft 1 2 3 4 5 6 7 8 9 10),
                params[:bed_min]), class: 'form-control') %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= select_tag(:bed_max,
                options_for_select(%w(Any Studio/Loft 1 2 3 4 5 6 7 8 9 10),
                params[:bed_max]), class: 'form-control') %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-3">
              <%= label_tag(:unit, "Baths") %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= select_tag(:bath_min,
                options_for_select(%w(Any 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6 6.5 7 7.5 8 8.5 9 9.5 10),
                params[:bath_min]), class: 'form-control') %>
            </div>
            <div class="col-xs-4 col-sm-left-padding">
              <%= select_tag(:bath_max,
                options_for_select(%w(Any 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6 6.5 7 7.5 8 8.5 9 9.5 10),
                params[:bath_max]), class: 'form-control') %>
            </div>
          </div>
          <!-- <div class="row vertical-padding">
            <div class="col-xs-5">
              <%#= label_tag(:listing_id, "Listing ID") %>
            </div>
            <div class="col-xs-6 col-sm-left-padding">
              <%#= text_field_tag :listing_id, params[:listing_id], class:"form-control" %>
            </div>
          </div> -->
          <div class="row vertical-padding">
            <div class="col-xs-5">
              <%= label_tag(:landlord, "Landlord ") %>
            </div>
            <div class="col-xs-6 col-sm-left-padding">
              <%= autocomplete_field_tag :landlord, params[:landlord],
                autocomplete_landlord_code_residential_listings_path,
                update_elements: {},
                placeholder: "code",
                size: 30, class:'form-control' %>
            </div>
          </div>
          <!-- <div class="row vertical-padding">
            <div class="col-xs-5">
              <%#= label_tag :ll_importance, "LL Class" %>
            </div>
            <div class="col-xs-6 col-sm-left-padding">
              <%#= select_tag(:ll_importance,
                  options_for_select(['Any', ['Gold', 'gold'], ['Silver', 'silver'], ['Bronze', 'bronze']],
                  params[:ll_importance] ? params[:ll_importance] : "Any"), class: 'form-control') %>
            </div>
          </div> -->
          <div class="row vertical-padding">
            <div class="col-xs-5">
              <%= label_tag :accepts_third_party_gaurantor, "Accepts Third-Party Gaurantor" %>
            </div>
            <div class="col-xs-6 col-sm-left-padding">
              <%= select_tag(:accepts_third_party_gaurantor, options_for_select([['Any','Any'],['Yes', 0], ['No', 1]], params[:accepts_third_party_gaurantor] ? params[:accepts_third_party_gaurantor].titleize : "Any"), class: 'form-control') %>
            </div>
          </div>
          <div class="row vertical-padding">
            <div class="col-xs-5">
              <%= label_tag :status, "Status" %>
            </div>
            <div class="col-xs-6 col-sm-left-padding">
              <%= select_tag(:status,
                  options_for_select(['Any', 'Active/Pending', 'Active', 'Pending', 'Off', 'Rented', 'Rsonly'],
                  params[:status] ? params[:status].titleize : "Active"), class: 'form-control') %>
              <%# if current_user.is_management? ||
                    current_user.is_listings_manager? ||
                    current_user.is_photo_manager? %>
                <%#= select_tag(:status,
                  options_for_select(['Any', 'Active/Pending', 'Active', 'Pending', 'Off'],
                  params[:status] ? params[:status].titleize : "Active"), class: 'form-control') %>
              <%# else %>
                <%#= select_tag(:status,
                  options_for_select(['Any', 'Active/Pending', 'Active', 'Pending'],
                  params[:status] ? params[:status].titleize : "Active"), class: 'form-control') %>
              <%# end %>
            </div>
          </div>
          <br>
          <div class="h-line"></div>
          <br>
          <div class="panel-group" id="accordion">
            <div class="panel panel-default">
              <div class="panel-heading" style="background-color: white;text-align: center;">
                 <h4 class="panel-title" data-toggle="collapse" data-target="#collapseOne">
                     Advance Search Options
                 </h4>
              </div>
              <div id="collapseOne" class="panel-collapse collapse">
                <!-- <div class="row vertical-padding">
                  <div class="col-xs-3">
                    <%#= label_tag(:public_url, "Public URL") %>
                  </div>
                  <div class="col-xs-8 col-sm-left-padding">
                    <%#= text_field_tag :public_url, params[:public_url], class:"form-control" %>
                  </div>
                </div> -->
                <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%= label_tag :has_fee, "Broker's Fee" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%= select_tag(:has_fee,
                      options_for_select(%w(Any Yes No), params[:has_fee]), class: 'form-control') %>
                  </div>
                </div>
                <!-- <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%#= label_tag :pet_policy_shorthand, "Pet policy" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%#= select_tag(:pet_policy_shorthand,
                      options_for_select(["Any", "Cats Only", "Dogs Only", "None"],
                      [params[:pet_policy_shorthand] ? params[:pet_policy_shorthand].titleize : "Any"]),
                      class: 'form-control') %>
                  </div>
                </div> -->

                <% if !params[:pet_policy_shorthand].nil? %>
                  <%= hidden_field_tag :pet_policy_shorthand, params[:pet_policy_shorthand] %>
                <% else %>
                  <%= hidden_field_tag :pet_policy_shorthand %>
                <% end %>
                <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%= label_tag :pet_policy_shorthand, "Pet policy" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding" style="width: 54%;">
                    <a href="javascript:;" class="test_p" style="margin-left: 0px;" data-target="#demo_pet_policy">Pet Policy</a>
                    <div class="row vertical-padding test_c" id="demo_pet_policy" style="display: none;">
                      <!-- <div class="col-xs-11 selectize-wrapper"> -->

                          <% PetPolicy.where(id: [19,17,1,4,8]).each do |pet_policy| %>
                            <div class="col-sm-6" id="unit-amenities-select-multiple">
                              <% if params[:pet_policy_shorthand] %>  
                                <% if (params[:pet_policy_shorthand].split(",").include? "#{pet_policy.id}") %>
                                  <span class="child-input"><input type="checkbox" name="features[]" value="<%= pet_policy.id %>" id="parent_<%= pet_policy.id %>" checked="true" onClick = "pet_policy_check(<%= pet_policy.id %>)" ><b><%= pet_policy.name.titleize %></b></span>
                                <% else %>
                                  <span class="child-input"><input type="checkbox" name="features[]" value="<%= pet_policy.id %>" id="parent_<%= pet_policy.id %>" onClick = "pet_policy_check(<%= pet_policy.id %>)" ><b><%= pet_policy.name.titleize %></b></span>
                                <% end %>
                              <% else %>
                                <span class="child-input"><input type="checkbox" name="features[]" value="<%= pet_policy.id %>" id="parent_<%= pet_policy.id %>" onClick = "pet_policy_check(<%= pet_policy.id %>)" ><b><%= pet_policy.name.titleize %></b></span>
                              <% end %>
                              <br>
                            </div>
                          <% end %>
                      <!-- </div> -->
                    </div>
                  </div>
                </div>

                <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%= label_tag :point_of_contact, "Point of Contact", class: "field-label-sm" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%= select_tag(:point_of_contact,
                      options_for_select(@user,
                          [params[:point_of_contact] ? params[:point_of_contact].titleize : "Any"]),
                        {prompt: "Choose one...",
                        class: 'form-control'}) %>
                  </div>
                </div>
                <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%= label_tag :primary_agent_id, "Agent" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%= select_tag(:primary_agent_id,
                      options_for_select(current_user.company.users.unarchived.collect {|u| [u.name, u.id]},
                          [params[:primary_agent_id] ? params[:primary_agent_id].titleize : "Any"]),
                        {prompt: "Choose one...",
                        class: 'form-control'}) %>
                  </div>
                </div>
                 <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%= label_tag :listing_agent_id, "Listing Agent" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%= select_tag(:listing_agent_id,
                      options_for_select(current_user.company.users.unarchived.collect {|u| [u.name, u.id]},
                          [params[:listing_agent_id] ? params[:listing_agent_id].titleize : "Any"]),
                        {prompt: "Choose one...",
                        class: 'form-control'}) %>
                  </div>
                </div>
                <%# abort current_user.is_streeteasy_agent?.inspect %>
                <% if current_user.is_management? || current_user.is_streeteasy_agent? %>
                  <div class="row vertical-padding">
                    <div class="col-xs-5">
                      <%= label_tag :streeteasy_filter, "On Streeteasy" %>
                    </div>
                    <div class="col-xs-6 col-sm-left-padding">
                      <%= select_tag(:streeteasy_filter,
                          options_for_select(['Any', 'Yes', 'No'],
                          [params[:streeteasy_filter] ? params[:streeteasy_filter].titleize : 'Any']),
                          class: 'form-control') %>
                    </div>
                  </div>
                <% end %>

                <% if current_user.is_company_admin? || current_user.is_super_admin? %>
                  <!-- <div class="row vertical-padding">
                    <div class="col-xs-5">
                      <%#= label_tag :streeteasy_claim, "Claim for Streeteasy" %>
                    </div>
                    <div class="col-xs-6 col-sm-left-padding">
                      <%#= select_tag(:streeteasy_claim,
                          options_for_select(['Any', 'Yes', 'No'],
                          [params[:streeteasy_claim] ? params[:streeteasy_claim].titleize : 'Any']),
                          class: 'form-control') %>
                    </div>
                  </div> -->
                <% end %>
                <%# if current_user.is_company_admin? || current_user.is_super_admin? || current_user.is_listings_manager? %>
                  <!-- <div class="row vertical-padding">
                    <div class="col-xs-5">
                      <%#= label_tag :building_rating, "STREETEASY ELIGIBLE" %>
                    </div>
                    <div class="col-xs-6 col-sm-left-padding">
                      <%#= select_tag(:building_rating, options_for_select([['Any','Any'],['Yes', 0], ['No', 1]], params[:building_rating] ? params[:building_rating].titleize : "Any"), class: 'form-control') %>
                    </div>
                  </div> -->
                <%# end %>

                <% if current_user.is_company_admin? || current_user.is_super_admin? || current_user.is_listings_manager? %>
                  <div class="row vertical-padding">
                    <div class="col-xs-5">
                      <%= label_tag :streeteasy_eligibility, "STREETEASY ELIGIBLE" %>
                    </div>
                    <div class="col-xs-6 col-sm-left-padding">
                      <%= select_tag(:streeteasy_eligibility, options_for_select([['Any','Any'],['Yes', 0], ['No', 1]], params[:streeteasy_eligibility] ? params[:streeteasy_eligibility].titleize : "Any"), class: 'form-control') %>
                    </div>
                  </div>
                <% end %>
                <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%= label_tag :tenant_occupied, "Tenant Occupieds or Not" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%= select_tag(:tenant_occupied, options_for_select([['Any','Any'],['Tenant Occupied', 0], ['Not Tenant Occupied', 1]], params[:tenant_occupied] ? params[:tenant_occupied].titleize : "Any"), class: 'form-control') %>
                  </div>
                </div>
                <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%= label_tag :youtube_video_url, "Video Present Or Not" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%= select_tag(:youtube_video_url, options_for_select([['Any','Any'],['Video Present', 0], ['Not Video Present', 1]], params[:youtube_video_url] ? params[:youtube_video_url].titleize : "Any"), class: 'form-control') %>
                  </div>
                </div>
                <!-- <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%#= label_tag :tour_3d, "3D Tour Present Or Not" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%#= select_tag(:tour_3d, options_for_select([['Any','Any'],['3D Tour Present', 0], ['Not 3D Tour Present', 1]], params[:tour_3d] ? params[:tour_3d].titleize : "Any"), class: 'form-control') %>
                  </div>
                </div> -->
                <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%= label_tag :train_line, "Train Lines" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    
                    <%= select_tag(:train_line, options_for_select(Train.all.collect {|u| [u.name, u.id]}.unshift(["Any", 0]),
                params[:train_line] ? params[:train_line].titleize : "Any"), class: 'form-control') %>
                  </div>
                </div>
                <%# if current_user.is_company_admin? || current_user.is_super_admin? || current_user.is_listings_manager? %>
                  <!-- <div class="row vertical-padding">
                    <div class="col-xs-5">
                      <%#= label_tag :landlord_rating, "Landlord Rating" %>
                    </div>
                    <div class="col-xs-6 col-sm-left-padding">
                      <%#= select_tag(:landlord_rating, options_for_select([['Any','Any'],['NA', 0], ['Excellent', 1], ['Good', 2], ['Fair', 3]], params[:landlord_rating] ? params[:landlord_rating].titleize : "Any"), class: 'form-control') %>
                    </div>
                  </div> -->
                <%# end %>
                <div class="row vertical-padding">
                  <div class="col-xs-12">
                    <strong>Available</strong>
                  </div>
                </div>
                <div class="row vertical-padding">
                  <div class="col-xs-6 col-sm-left-padding">
                    <div class='input-group date datepicker'>
                      <%= text_field_tag :available_starting, params[:available_starting],
                        placeholder: "start", class:"form-control", size:30 %>
                      <label class="input-group-addon btn" for="date">
                        <span class="fa fa-calendar open-datepicker"></span>
                      </label>
                    </div>
                  </div>
                  <div class="col-xs-5 col-sm-left-padding">
                    <div class='input-group date datepicker'>
                      <%= text_field_tag :available_before, params[:available_before],
                        placeholder: "by", class:"form-control" %>
                      <label class="input-group-addon btn" for="date">
                        <span class="fa fa-calendar open-datepicker"></span>
                      </label>
                    </div>
                  </div>
                </div>

                <div class="row vertical-padding">
                  <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :roomsharing_filter, "".freeze, params[:roomsharing_filter] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="roomsharing_filter">
                        Roomshares
                      </label>
                    </div>
                  </div>
                  <% if current_user.is_management? %>
                    <div class="col-xs-6">
                      <div class="checkbox checkbox-warning inline">
                        <%= check_box_tag :unassigned_filter, "".freeze, params[:unassigned_filter] == "true".freeze   ? true : false,
                            class: 'styled' %>
                        <label for="unassigned_filter">
                          Unassigned
                        </label>
                      </div>
                    </div>
                  <% end %>
                </div>

                <div class="row vertical-padding">
                  <div class="col-xs-6">
                    <!-- <div class="checkbox checkbox-warning inline">
                      <%#= check_box_tag :tenant_occupied_filter, "".freeze, params[:tenant_occupied_filter] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="tenant_occupied_filter">
                        Tenant Occupied
                      </label>
                    </div> -->
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :exclusive_filter, "".freeze, params[:exclusive_filter] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="roomsharing_filter">
                        Exclusive Listing
                      </label>
                    </div>
                  </div>
                  <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :has_stock_photos_filter, "".freeze, params[:has_stock_photos_filter] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="has_stock_photos_filter">
                        Stock Photos
                      </label>
                    </div>
                  </div>
                </div>

                <div class="row vertical-padding">
                  <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :no_description, "".freeze, params[:no_description] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="no_description">
                        No Description
                      </label>
                    </div>
                  </div>
                  <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :no_images, "".freeze, params[:no_images] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="no_images">
                        No Images
                      </label>
                    </div>
                  </div>
                  <!-- <div class="row vertical-padding"> -->
                  <!-- <div class="col-xs-6">
                    
                  </div> -->
                </div>
                <div class="row vertical-padding">
                  <% if current_user.is_management? %>
                    <div class="col-xs-6">
                      <div class="checkbox checkbox-warning inline">
                        <%= check_box_tag :third_tier, "".freeze, params[:third_tier] == "true".freeze ? true : false,
                            class: 'styled' %>
                        <label for="third_tier">
                          Third Tier
                        </label>
                      </div>
                    </div>
                  <% end %>
                  <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :pending_se, "".freeze, params[:pending_se] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="pending_se">
                        Pending Se
                      </label>
                    </div>
                  </div>
                </div>
                <div class="row vertical-padding">
                  <!-- <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%#= check_box_tag :managed_listing, "".freeze, params[:managed_listing] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="managed_listing">
                        NO DS
                      </label>
                    </div>
                  </div> -->
                  <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :featured, "".freeze, params[:featured] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="featured">
                        Featured
                      </label>
                    </div>
                  </div>
                  <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :tenant_credit_offered, "".freeze, params[:tenant_credit_offered] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="tenant_credit_offered">
                        Agent Bonus Offered
                      </label>
                    </div>
                  </div>
                </div>
                <div class="row vertical-padding">
                  
                  <div class="col-xs-6">
                    <div class="checkbox checkbox-warning inline">
                      <%= check_box_tag :past_24_hours_active, "".freeze, params[:past_24_hours_active] == "true".freeze ? true : false,
                          class: 'styled' %>
                      <label for="past_24_hours_active">
                        Past 24 Hours Active
                      </label>
                    </div>
                  </div>
                </div>
                <!-- <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%#= label_tag :parent_neighborhoods, "Parent Neighborhoods" %>
                  </div>
                  <div class="col-xs-6 col-sm-left-padding">
                    <%#= select_tag(:parent_neighborhoods,
                        options_for_select(Neighborhood.where(parent_neighborhoods: 1).collect {|u| [u.name.titleize, u.id]},
                        params[:parent_neighborhoods] ? params[:parent_neighborhoods].titleize : "Any"),{ prompt: "Choose one...", class: 'form-control'}) %>
                  </div>
                </div> -->

                <!-- <div class="row vertical-padding">
                  <div class="col-xs-11 selectize-wrapper">
                    <select id="neighborhood-select-multiple" placeholder="Neighborhoods...">
                      <%# @neighborhoods.each do |borough, list| %>
                        <optgroup label="<%#= borough %>">
                          <%# list.each do |neighborhood| %>
                            <option value="<%#= neighborhood.id %>"><%#= neighborhood.name %></option>
                          <%# end %>
                        </optgroup>
                      <%# end %>
                    </select>
                  </div>
                </div> -->
                <% if !params[:parent_neighborhoods].nil? %>
                  <%= hidden_field_tag :parent_neighborhoods, params[:parent_neighborhoods] %>
                <% else %>
                  <%= hidden_field_tag :parent_neighborhoods %>
                <% end %>
                <a href="javascript:;" class="test_p" data-target="#demo_neghb">Neighborhoods</a>
                <div class="row vertical-padding test_c" id="demo_neghb" style="display: none;">
                  <% @neighborhoods = Neighborhood.all %>
                  <% @neighborhoods.where(parent_neighborhood_id: 0).each do |neighborhood| %>
                    <div class="col-sm-6">
                          <input type="checkbox" name="neighborhood[]" value="<%= neighborhood.id %>" id="parent_<%= neighborhood.id %>" onClick = "parent_neighborhoods_check(<%= neighborhood.id %>)" ><b><%= neighborhood.name.titleize %></b>
                          <br>
                          <% @neighborhoods.where(parent_neighborhood_id: neighborhood.id).each do |child_neighborhood| %>
                            <% if params[:parent_neighborhoods] %>
                              <% if params[:parent_neighborhoods].split(",").include? "#{child_neighborhood.id}" %>
                                <span class="child-input"><input type="checkbox" name="neighborhood[]" value="<%= child_neighborhood.id %>" data-parent-id= "<%= child_neighborhood.parent_neighborhood_id %>" id="child_with_parent_neghb_<%= child_neighborhood.id %>" checked="true" onClick = "child_neighborhoods_uncheck(<%= child_neighborhood.id %>)"><%= child_neighborhood.name.titleize %></span>
                              <% else %>
                                <span class="child-input"><input type="checkbox" name="neighborhood[]" value="<%= child_neighborhood.id %>" data-parent-id= "<%= child_neighborhood.parent_neighborhood_id %>" id="child_with_parent_neghb_<%= child_neighborhood.id %>" onClick = "child_neighborhoods_uncheck(<%= child_neighborhood.id %>)"><%= child_neighborhood.name.titleize %></span>
                              <% end %>
                            <% else %>
                              <span class="child-input"><input type="checkbox" name="neighborhood[]" value="<%= child_neighborhood.id %>" data-parent-id= "<%= child_neighborhood.parent_neighborhood_id %>" id="child_with_parent_neghb_<%= child_neighborhood.id %>" onClick = "child_neighborhoods_uncheck(<%= child_neighborhood.id %>)"><%= child_neighborhood.name.titleize %></span>
                            <% end %>
                          <% end %>
                    </div>
                  <% end %>
                </div>
                
                <!-- <div class="row vertical-padding">
                  <div class="col-xs-5">
                    <%#= label_tag :parent_amenities, "Parent Amenities" %>
                  </div>
                  <br>
                  <br>
                  <div class="col-xs-11 vertical-padding">
                    <%# list_info = [['Utilities(+ $150 Utilities,Cable Included,Free Laundry,Free WIFI,Heat + Hot Water Included,No Utilities Included,Washer/Dryer Hookups)', 145], ['Heating & Cooling(Air Conditioning Unit,Ceiling Fans,Central A/C,Central Heat,HVAC,Working Fireplace)', 146], ['Layout(Alcove,Basement,Den,Driveway,Duplex,Kitchen Island,Loft,Mezzanine,Office,Penthouse,Railroad,Triplex,Walk-In Closet)', 147],['Outdoor Space(Backyard,Balcony,Balcony/Terrace,Greenhouse,Outside Space,Patio/Deck,Paved Outdoor Space,Private Deck,Private Outdoor Space,Private Patio,Private Roof Deck,Private Terrace,Private Yard,Shared Outdoor Patio,Shared Roof Deck,Shared Terrace,Shared Yard,Terrace)', 148], ['Amenities(Bike Room,Doorman,Elevator,Freight Elevator,Fully Furnished,Garage,Gym,Handicap Elevator,Laundry Room,Lounge,On Site Super,Parking,Roof Access,Storage Space,Swimming Pool,Washer/Dryer In-Unit)', 149], ['Speakers & Audio Systems(Bluetooth Speaker System,Butterflymx Intercom System,Video Intercom,Virtual Doorman,Voice Intercom)', 150], ['Appliances(Brand New Appliances,Dishwasher,Microwave,Stainless Steel Appliances,Top of the Line GE Appliances,Wine Cooler)', 151], ['Finishes(Brand New Finishes,Chefs Kitchens,Exposed Brick,Fireplace,Floor To Ceiling Windows,Granite Countertops,Hardwood Floors,High Ceilings,Juliette Balcony,Modern Finishes,Original Detail,Renovated,Skylight)', 152], ['Features(City Views,Open Listing,Private Elevator)', 153], ['Denison(Denison Grey,Denison Metal,Denison Wood)', 154]] %>
                    <%#= select_tag(:parent_amenities,
                        options_for_select(list_info,
                        params[:parent_amenities] ? params[:parent_amenities].titleize : "Any"),{ prompt: "Choose one...", class: 'form-control'}) %>
                  </div>
                </div> -->
                <% if !params[:parent_amenities].nil? %>
                  <%= hidden_field_tag :parent_amenities, params[:parent_amenities] %>
                <% else %>
                  <%= hidden_field_tag :parent_amenities %>
                <% end %>
                <a href="javascript:;" class="test_p" data-target="#demo">Unit features</a>
                <div class="row vertical-padding test_c" id="demo" style="display: none;">
                  <!-- <div class="col-xs-11 selectize-wrapper"> -->
                      <%# @unit_amenities.where(parent_amenity_id: 0).each do |amenity| %>
                        <!-- <div class="col-sm-6" id="unit-amenities-select-multiple"> -->
                          <input type="checkbox" name="features[]" value="" id="parent" onClick = "select_all_unit_amenities(this)" ><b>Select All</b>
                          <br>
                          <%# abort params[:parent_amenities].split(",").inspect %>
                          <% @unit_amenities.each do |amenity| %>
                            <% if params[:parent_amenities] %>
                              <% if params[:parent_amenities].split(",").include? "#{amenity.id}" %>
                                <span class="child-input"><input type="checkbox" name="unit_features[]" value="<%= amenity.id %>" data-parent-id= "<%= amenity.parent_amenity_id %>" id="child_with_parent_<%= amenity.id %>" checked="true" onClick = "child_amenities_uncheck(<%= amenity.id %>)"><%= amenity.name.titleize %></span>
                              <% else %>
                                <span class="child-input"><input type="checkbox" name="unit_features[]" value="<%= amenity.id %>" data-parent-id= "<%= amenity.parent_amenity_id %>" id="child_with_parent_<%= amenity.id %>" onClick = "child_amenities_uncheck(<%= amenity.id %>)"><%= amenity.name.titleize %></span>
                              <% end %>
                            <% else %>
                              <span class="child-input"><input type="checkbox" name="unit_features[]" value="<%= amenity.id %>" data-parent-id= "<%= amenity.parent_amenity_id %>" id="child_with_parent_<%= amenity.id %>" onClick = "child_amenities_uncheck(<%= amenity.id %>)"><%= amenity.name.titleize %></span>
                            <% end %>
                          <% end %>
                          <br>
                        <!-- </div> -->
                      <%# end %>
                  <!-- </div> -->
                </div>

                <% if !params[:parent_building_amenities].nil? %>
                  <%= hidden_field_tag :parent_building_amenities, params[:parent_building_amenities] %>
                <% else %>
                  <%= hidden_field_tag :parent_building_amenities %>
                <% end %>
                <a href="javascript:;" class="test_p" data-target="#demo_build_feat">Building features</a>
                <div class="row vertical-padding test_c" id="demo_build_feat" style="display: none;">
                  <!-- <div class="col-xs-11 selectize-wrapper"> -->
                      <input type="checkbox" name="features[]" value="" id="parent" onClick = "select_all_building_amenities(this)" ><b>Select All</b>
                      <br>
                      <% @building_amenities.each do |amenity| %>
                        <!-- <div class="col-sm-6" id= "building-amenities-select-multiple"> -->
                        <% if params[:parent_building_amenities] %>
                          <% if params[:parent_building_amenities].split(",").include? "#{amenity.id}" %>
                            <span class="child-input"><input type="checkbox" name="building_features[]" value="<%= amenity.id %>" data-parent-id= "<%= amenity.id %>" class= "child_with_parent_building" checked="true" id="child_with_parent_building_<%= amenity.id %>" onClick = "child_building_amenities_uncheck(<%= amenity.id %>)"><%= amenity.name.titleize %></span>
                          <% else %>
                            <span class="child-input"><input type="checkbox" name="building_features[]" value="<%= amenity.id %>" data-parent-id= "<%= amenity.id %>" class= "child_with_parent_building" id="child_with_parent_building_<%= amenity.id %>" onClick = "child_building_amenities_uncheck(<%= amenity.id %>)"><%= amenity.name.titleize %></span>
                          <% end %>
                        <% else %>
                          <span class="child-input"><input type="checkbox" name="building_features[]" value="<%= amenity.id %>" data-parent-id= "<%= amenity.id %>" class= "child_with_parent_building" id="child_with_parent_building_<%= amenity.id %>" onClick = "child_building_amenities_uncheck(<%= amenity.id %>)"><%= amenity.name.titleize %></span>
                        <% end %>
                        <!-- </div> -->
                      <% end %>
                  <!-- </div> -->
                </div>
              </div>
            </div>
          </div>
          <!-- <div class="row vertical-padding" style="display: none;">
            <div class="col-xs-11 selectize-wrapper">
              <select id="unit-amenities-select-multiple" placeholder="Unit features...">
                <%# @unit_amenities.each do |amenity| %>
                  <option value="<%#= amenity.id %>"><%#= amenity.name.titleize %></option>
                <%# end %>
              </select>
            </div>
          </div> -->

          <!-- <div class="row vertical-padding">
            <div class="col-xs-11 selectize-wrapper">
              <select id="building-amenities-select-multiple" placeholder="Building features...">
                <optgroup label="Building">
                  <%# @building_amenities.each do |amenity| %>
                    <option value="<%#= amenity.id %>"><%#= amenity.name.titleize %></option>
                  <%# end %>
                </optgroup>
              </select>
            </div>
          </div> -->
          <% if current_user.is_data_entry? || current_user.is_data_entry2? %>
            <%= hidden_field_tag :hd_for_ll_class, "true" %>
          <% else %>
            <%= hidden_field_tag :hd_for_ll_class, "false" %>
          <% end %>
          <div class="row vertical-padding">
            <div class="col-xs-11 col-sm-left-padding">
              <button id='res-search-trigger', class="search-trigger btn btn-warning btn-sm form-control">
                Search
              </button>
            </div>
          </div>
        <% end %>
        <div class="row vertical-padding">
          <div class="col-xs-11 col-sm-left-padding">
            <button class="search-trigger btn btn-warning btn-sm form-control" style="background-color: #a7a5a3;border-color: #969593;" onclick="clearsearchdata()">
              Clear Search Fields
            </button>
          </div>
        </div>
      </div>
    </div>

   <div class="col-md-9 hidden-xs hidden-sm">
      <div id="r-big-map" data-map-points="<%= @map_infos %>"></div>
      <!-- <div id="map_c" style="width: 100%; height: 615px;"></div> -->
    </div>
  </div>

  <div class="hidden-xs hidden-sm">
    <hr class="map-hr">
  </div>

  <%= form_tag print_list_residential_listings_path do %>
  <div class="row r-search-rs">
    <div class="col-md-3 vertical-margin-lg">
      <!-- will be a dropdown of either print pdf or email -->
      <div class="dropdown selected-listings">
        <button class="btn btn-warning btn-sm dropdown-toggle disabled" id="selected-listings-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" role="menu">
          0 Selected Listings
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu selected-listings-menu" aria-labelledby="selected-listings-dropdown">
          <% if current_user.is_management? %>
            <li role="presentation"><a class="list-item-sm-padding" id="assignListings" role="menuitem" tabindex="-1" data-toggle="modal" data-target="#unitAssignModal">
            <i class="fa fa-fw fa-child"></i> Assign Agent</a></li>

            <li role="presentation"><a class="list-item-sm-padding" id="unassignListings" role="menuitem" tabindex="-1" data-toggle="modal" data-target="#unitUnassignModal">
            <i class="fa fa-fw fa-child"></i> Unassign Agent</a></li>
          <% end %>

          <li role="presentation"><a class="list-item-sm-padding" id="emailListings" role="menuitem" tabindex="-1" data-toggle="modal" data-target="#emailModal">
            <i class="fa fa-fw fa-envelope"></i> Email</a></li>

          <!--li role="presentation"><a class="list-item-sm-padding" data-action="listingsSheet" role="menuitem" tabindex="-1">
            <i class="fa fa-fw fa-file-text"></i> Show Sheet</a></li-->

          <li role="presentation"><a class="list-item-sm-padding" data-action="internalListingsSheet" role="menuitem" tabindex="-1">
            <i class="fa fa-fw fa-list"></i> Internal Listings Sheet</a></li>
        </ul>
      </div>
      <% if !current_user.is_third_tier_agent? %>
        <% if !@residential_units.where('units.hide_from_agent =?', true).blank? && current_user.is_special_agent? %>
            <% @hide_agents_count = @residential_units.where('units.hide_from_agent =?', true).count %>
            <span class="totals">
              &nbsp;&nbsp;<%= @residential_units.total_entries - @hide_agents_count %> Units found
            </span>
        <%# elsif !@residential_units.where('units.third_tier =?', true).blank? && current_user.is_third_tier_agent? %>
            <!-- <span class!current_user.is_third_tier_agent?="totals">
              &nbsp;&nbsp;<%#= @residential_units.where('units.third_tier =?', true).count %> Units found
            </span> -->
        <% else %>
            <span class="totals">
              &nbsp;&nbsp;<%= @residential_units.total_entries %> Units found
            </span>
        <% end %>
      <% end %>
    </div>
    <div class="col-md-9 vertical-margin-lg">
      <span>Current Search</span>
      <br>
      <% if !params[:address].nil? %>
        <strong>Address: </strong>: <%= params[:address] %>
      <% end %>
      <% if !params[:unit].nil? %>
        | <strong>Unit: </strong>: <%= params[:unit] %>
      <% end %>
      <% if !params[:rent_min].nil? %>
        | <strong>Min Rent: </strong>: <%= params[:rent_min] %>
      <% end %>
      <% if !params[:rent_max].nil? %>
        | <strong>Max Rent: </strong>: <%= params[:rent_max] %>
      <% end %>
      <% if !params[:bed_min].nil? %>
        | <strong>Min Bed: </strong>: <%= params[:bed_min] %>
      <% end %>
      <% if !params[:bed_max].nil? %>
        | <strong>Max Bed: </strong>: <%= params[:bed_max] %>
      <% end %>
      <% if !params[:bath_min].nil? %>
        | <strong>Min Bath: </strong>: <%= params[:bath_min] %>
      <% end %>
      <% if !params[:bath_max].nil? %>
        | <strong>Max Bath: </strong>: <%= params[:bath_max] %>
      <% end %>
      <% if !params[:landlord].nil? %>
        | <strong>Landlord: </strong>: <%= params[:landlord] %>
      <% end %>
      <% if !params[:ll_importance].nil? && params[:ll_importance] != "Any" %>
        | <strong>LL Class: </strong>: <%= params[:ll_importance] %>
      <% end %>
      <% if !params[:accepts_third_party_gaurantor].nil? && params[:accepts_third_party_gaurantor] != "Any" %>
        | <strong>Accepts Third-Party Gaurantor: </strong>: 
        <% if params[:accepts_third_party_gaurantor] == "0" %>
          Yes
        <% else %>
          No
        <% end %>
      <% end %>
      <% if !params[:status].nil? %>
        | <strong>Status: </strong>: <%= params[:status] %>
      <% end %>
      <% if !params[:public_url].nil? %>
        | <strong>Public URL: </strong>: <%= params[:public_url] %>
      <% end %>
      <% if !params[:has_fee].nil?  && params[:has_fee] != "Any" %>
        | <strong>Broker's Fee: </strong>: 
        <% if params[:has_fee] == "Yes" %>
          Yes
        <% else %>
          No
        <% end %>
      <% end %>
      <% if !params[:pet_policy_shorthand].nil? %>
        <strong>Pet Policy: </strong> <%= params[:pet_policy_shorthand].split(",").each.map{|a| PetPolicy.find(a.to_i).name}.join(",")  %>
      <% end %>
      <% if !params[:point_of_contact].nil? %>
        | <strong>Point Of Contact: </strong>: <%= User.find(params[:point_of_contact]).name %>
      <% end %>
      <% if !params[:primary_agent_id].nil? %>
        | <strong>Agent: </strong>: <%= User.find(params[:primary_agent_id]).name %>
      <% end %>
      <% if !params[:streeteasy_filter].nil? && params[:streeteasy_filter] != "Any" %>
        | <strong>On Streeteasy: </strong>: 
        <% if params[:streeteasy_filter] == "Yes" %>
          Yes
        <% else %>
          No
        <% end %>
      <% end %>
      <% if !params[:streeteasy_claim].nil? && params[:streeteasy_claim] != "Any" %>
        | <strong>Streeteasy Claim: </strong>: 
        <% if params[:streeteasy_claim] == "Yes" %>
          Yes
        <% else %>
          No
        <% end %>
      <% end %>
      <% if !params[:streeteasy_eligibility].nil? && params[:streeteasy_eligibility] != "Any" %>
        | <strong>Streeteasy Eligibility: </strong>: 
        <% if params[:streeteasy_eligibility] == "0" %>
          Yes
        <% else %>
          No
        <% end %>
      <% end %>
      <% if !params[:tenant_occupied].nil? && params[:tenant_occupied] != "Any" %>
        | <strong>Tenant Occupied: </strong>: 
        <% if params[:tenant_occupied] == "0" %>
          Tenant Occupied
        <% else %>
          Not Tenant Occupied
        <% end %>
      <% end %>
      <% if !params[:youtube_video_url].nil? && params[:youtube_video_url] != "Any" %>
        | <strong>Video Present Or Not: </strong>: 
        <% if params[:youtube_video_url] == "0" %>
          Video Present
        <% else %>
          Not Video Present
        <% end %>
      <% end %>
      <% if !params[:tour_3d].nil? && params[:tour_3d] != "Any" %>
        | <strong>3D Tour Present Or Not: </strong>: 
        <% if params[:tour_3d] == "0" %>
          3D Tour Present
        <% else %>
          Not 3D Tour Present
        <% end %>
      <% end %>
      <% if !params[:available_starting].nil? %>
        | <strong>Available Start: </strong>: <%= params[:available_starting] %>
      <% end %>
      <% if !params[:available_before].nil? %>
        | <strong>Available End</strong>: <%= params[:available_before] %>
      <% end %>
      <% if !params[:roomsharing_filter].nil? %>
        | <strong>Roomshares</strong>: <%= params[:roomsharing_filter] %>
      <% end %>
      <% if !params[:unassigned_filter].nil? %>
        | <strong>Unassigned</strong>: <%= params[:unassigned_filter] %>
      <% end %>
      <% if !params[:exclusive_filter].nil? %>
        | <strong>Exclusive Listing</strong>: <%= params[:exclusive_filter] %>
      <% end %>
      <% if !params[:has_stock_photos_filter].nil? %>
        | <strong>Stock Photos</strong>: <%= params[:has_stock_photos_filter] %>
      <% end %>
      <% if !params[:no_description].nil? %>
        | <strong>No Description</strong>: <%= params[:no_description] %>
      <% end %>
      <% if !params[:no_images].nil? %>
        | <strong>No Images</strong>: <%= params[:no_images] %>
      <% end %>
      <% if !params[:third_tier].nil? %>
        | <strong>Third Tier</strong>: <%= params[:third_tier] %>
      <% end %>
      <% if !params[:parent_neighborhoods].nil? %>
        | <strong>Neighborhoods</strong> <%= params[:parent_neighborhoods].split(",").each.map{|a| Neighborhood.find(a.to_i).name}.join(",")  %>
      <% end %>
      <% if !params[:parent_amenities].nil? %>
        | <strong>Unit Features</strong>  <%= params[:parent_amenities].split(",").each.map{|a| ResidentialAmenity.find(a.to_i).name}.join(",")  %>
      <% end %>
      <% if !params[:parent_building_amenities].nil? %>
        | <strong>Building Features</strong> <%= params[:parent_building_amenities].split(",").each.map{|a| BuildingAmenity.find(a.to_i).name}.join(",")  %>
      <% end %>
    </div>
  </div>

  <span id="infinite-table-container">
  <div class="row">
    <div class="col-md-12">
      <table class="sortable table table-striped table-hover table-condensed infinite-table-res">
        <thead>
          <tr>
            <th style="min-width: 35px;">
              <!-- checkboxes -->
              <i data-action="selectAllUnits" class="select-all-listings fa fa-square-o fa-lg"></i>
            </th>
            <th class="img-col"><!-- first image --></th>
            <th>Address</th>
            <!-- <th data-sort="building_unit" class="th-sortable">Unit</th> -->
            <th style="min-width: 20%;">Access</th>
            <th>Touring Options</th>
            <th>Beds/Baths</th>
            <th style="min-width: 125px;">Price</th>
            <!-- <th data-sort="available_by" class="th-sortable">Available</th> -->
            <!-- <th data-sort="code" class="th-sortable">Landlord</th> -->
            <!-- <th data-sort="name" class="th-sortable">Primary Agent</th>
            <th data-sort="name" class="th-sortable">StreetEasy Primary Agent</th> -->
            <!-- <th data-sort="name" class="th-sortable">Point Of Contact</th> -->
            <th>Updated</th>
            <!-- <th data-sort="residential_listings.updated_at" class="th-sortable">Price Change Date</th> -->
            <% if current_user.is_management? %>
              <th>Syndicated</th>
            <% end %>
            <% if [505,255,555].include? current_user.id %>
              <th>Key</th>
            <% end %>
            <!-- <th data-sort="units.status" class="th-sortable">Status</th>
            <th data-sort="featured" class="th-sortable">Featured</th> -->
            <% if current_user.is_management? || current_user.is_listings_manager? %>
              <th colspan="1" class="hidden-print"></th>
            <% end %>
          </tr>
        </thead>

        <tbody class="residential_units_table_body">
          <%= render partial: 'residential_listings/residential_listing',
            collection: @residential_units.sort{|a,b| b.updated_at <=> a.updated_at}, locals: {
              res_images: @res_images, bldg_images: @bldg_images
            } %>
        </tbody>
      </table>
    </div>
  </div>
  <% if !current_user.is_third_tier_agent? %>
    <div class="row">
      <div class="col-md-12">
        <div class="apple_pagination">
          <%= will_paginate @residential_units, :container => false %>
        </div>
      </div>
    </div>
  <% end %>

  </span>

  <% end %><!-- form -->

  <%# Template Dependency: residential_listings/modals %>
  <%= render 'modals' %>

  </div>
</div>
